"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const checkFtKey = (req, res, next) => {
    const user = req.user;
    if (!user) {
        res.status(403).send('Unauthorized');
        return;
    }
    if (user === null || user === void 0 ? void 0 : user.email) {
        const projectKey = req.headers["ft-key"];
        if (!projectKey) {
            res.status(400).send("Bad ft-key");
            return;
        }
        req.projectKey = projectKey;
    }
    next();
};
exports.default = checkFtKey;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQzovVXNlcnMvaW9yb3MvRG9jdW1lbnRzL3BsYXlncm91bmQvZG9ja2VyLXNlcnZpY2VzL2ZlYXR1cmUtdG9nZ2xlci9mZWF0dXJlLXRvZ2dsZXItYmFja2VuZC9zcmMvbWlkZGxld2FyZXMvY2hlY2tGdEtleS50cyIsInNvdXJjZXMiOlsiQzovVXNlcnMvaW9yb3MvRG9jdW1lbnRzL3BsYXlncm91bmQvZG9ja2VyLXNlcnZpY2VzL2ZlYXR1cmUtdG9nZ2xlci9mZWF0dXJlLXRvZ2dsZXItYmFja2VuZC9zcmMvbWlkZGxld2FyZXMvY2hlY2tGdEtleS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUVBLE1BQU0sVUFBVSxHQUFHLENBQUMsR0FBWSxFQUFFLEdBQWEsRUFBRSxJQUFrQixFQUFFLEVBQUU7SUFDbkUsTUFBTSxJQUFJLEdBQUcsR0FBRyxDQUFDLElBQUksQ0FBQztJQUN0QixJQUFHLENBQUMsSUFBSSxFQUFFO1FBQ04sR0FBRyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLENBQUM7UUFDckMsT0FBTztLQUNWO0lBQ0QsSUFBRyxJQUFJLGFBQUosSUFBSSx1QkFBSixJQUFJLENBQUUsS0FBSyxFQUFFO1FBQ1osTUFBTSxVQUFVLEdBQUcsR0FBRyxDQUFDLE9BQU8sQ0FBQyxRQUFRLENBQVcsQ0FBQztRQUNuRCxJQUFJLENBQUMsVUFBVSxFQUFFO1lBQ2IsR0FBRyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUM7WUFDbkMsT0FBTztTQUNWO1FBQ0QsR0FBRyxDQUFDLFVBQVUsR0FBRyxVQUFVLENBQUM7S0FDL0I7SUFDRCxJQUFJLEVBQUUsQ0FBQztBQUNYLENBQUMsQ0FBQTtBQUVELGtCQUFlLFVBQVUsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFJlcXVlc3QsIFJlc3BvbnNlLCBOZXh0RnVuY3Rpb24gfSBmcm9tIFwiZXhwcmVzc1wiO1xyXG5cclxuY29uc3QgY2hlY2tGdEtleSA9IChyZXE6IFJlcXVlc3QsIHJlczogUmVzcG9uc2UsIG5leHQ6IE5leHRGdW5jdGlvbikgPT4ge1xyXG4gICAgY29uc3QgdXNlciA9IHJlcS51c2VyO1xyXG4gICAgaWYoIXVzZXIpIHtcclxuICAgICAgICByZXMuc3RhdHVzKDQwMykuc2VuZCgnVW5hdXRob3JpemVkJyk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgaWYodXNlcj8uZW1haWwpIHtcclxuICAgICAgICBjb25zdCBwcm9qZWN0S2V5ID0gcmVxLmhlYWRlcnNbXCJmdC1rZXlcIl0gYXMgc3RyaW5nO1xyXG4gICAgICAgIGlmICghcHJvamVjdEtleSkge1xyXG4gICAgICAgICAgICByZXMuc3RhdHVzKDQwMCkuc2VuZChcIkJhZCBmdC1rZXlcIik7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmVxLnByb2plY3RLZXkgPSBwcm9qZWN0S2V5O1xyXG4gICAgfVxyXG4gICAgbmV4dCgpO1xyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjaGVja0Z0S2V5OyJdfQ==